<script>
    import Buttons from './buttons/index.svelte';
    import Options from './options.svelte';
    import RecordDetails from './record-details.svelte';
    import { setContext } from 'svelte';

    export let config;
    export let startRecord;
    export let endRecord;
    export let handlers;
    export let containerWidth;

    const HUNDRED_PERCENT = '100%',
        FIFTY_PERCENT = '50%',
        THIRTY_THREE_PERCENT = '33.33%';
    let height= config.paginationHeight,
     showRecordCountEnabled,
     optionsEnabled,
     numRows = config.numRows,
     rowHeight = height / numRows,
     buttonsContainerWidth,
     optionsContainerWidth,
     showRecordCountContainerWidth,
     calculateWidth = (percentVal)=>{
         switch(percentVal){
            case HUNDRED_PERCENT:
                return containerWidth;
                break;
            case FIFTY_PERCENT:
                 return containerWidth * 0.5;
                 break;
            case THIRTY_THREE_PERCENT:
                 return containerWidth * 0.33;
                 break;
         }
     };

     setContext('handlers', handlers);

    $:{
        showRecordCountEnabled = config.showRecordCount;
        optionsEnabled = config.pageSize.options && config.pageSize.options.length;
        rowHeight = height / numRows;
        if (numRows === 2){
            buttonsContainerWidth = optionsContainerWidth = calculateWidth(FIFTY_PERCENT);
            showRecordCountContainerWidth = calculateWidth(HUNDRED_PERCENT);
        } else{
            if (!showRecordCountEnabled && !optionsEnabled){
                buttonsContainerWidth = calculateWidth(HUNDRED_PERCENT);
            } else if (!showRecordCountEnabled){
                buttonsContainerWidth = optionsContainerWidth = calculateWidth(FIFTY_PERCENT);
            } else if (!optionsEnabled){
                buttonsContainerWidth = showRecordCountContainerWidth = calculateWidth(FIFTY_PERCENT);
            } else{
                buttonsContainerWidth = optionsContainerWidth = showRecordCountContainerWidth = calculateWidth(THIRTY_THREE_PERCENT);
            }
        }
    }
</script>

<div class="fg-pagination-container fg-pagination" style="width: 100%; height: {height}px;">
    <div class="fg-pagination-buttons-container" style="width: {buttonsContainerWidth}px; height: {rowHeight}px;">
        <Buttons {config} width= {buttonsContainerWidth}/>
    </div>
    {#if optionsEnabled}
        <div class="fg-pagination-options-container" style="width: {optionsContainerWidth}px; height: {rowHeight}px;
            text-align: {optionsContainerWidth === containerWidth * 0.5 ? 'right' : 'center'}">
            <Options options={config.pageSize.options} pageSize={config.pageSize.applied} width={optionsContainerWidth} />
        </div>
    {/if}
    {#if showRecordCountEnabled}
        <div class="fg-pagination-record-display-container" style="width: {showRecordCountContainerWidth}px; height: {rowHeight}px;
            text-align: {(showRecordCountContainerWidth === containerWidth * 0.33 || !optionsEnabled) ? 'right' : 'left'}">
            <RecordDetails
                {startRecord}
                width={showRecordCountContainerWidth}
                {endRecord}
                totalRecords = {config.totalRecords}
            />
        </div>
    {/if}
</div>